# GitLeaks configuration for Proofile
title = "Proofile GitLeaks Configuration"

[extend]
# Extend default rules
useDefault = true

[[rules]]
description = "AWS Access Key ID"
id = "aws-access-key-id"
regex = '''AKIA[0-9A-Z]{16}'''
tags = ["key", "AWS"]

[[rules]]
description = "AWS Secret Access Key"
id = "aws-secret-access-key"
regex = '''[A-Za-z0-9/+=]{40}'''
tags = ["key", "AWS"]

[[rules]]
description = "OpenAI API Key"
id = "openai-api-key"
regex = '''sk-[A-Za-z0-9]{48}'''
tags = ["key", "OpenAI"]

[[rules]]
description = "Anthropic API Key"
id = "anthropic-api-key"
regex = '''sk-ant-[A-Za-z0-9\-_]{95}'''
tags = ["key", "Anthropic"]

[[rules]]
description = "Supabase API Key"
id = "supabase-api-key"
regex = '''eyJ[A-Za-z0-9_/+=\-]{100,}'''
tags = ["key", "Supabase"]

[[rules]]
description = "Database URL with credentials"
id = "database-url"
regex = '''postgresql://[^:]+:[^@]+@[^/]+/[^?\s]+'''
tags = ["database", "credentials"]

[[rules]]
description = "Redis URL with credentials"
id = "redis-url"
regex = '''redis://[^:]+:[^@]+@[^/]+'''
tags = ["database", "credentials"]

[[rules]]
description = "JWT Secret"
id = "jwt-secret"
regex = '''jwt[_-]?secret[_-]?key?\s*[:=]\s*["\']?[A-Za-z0-9+/=]{32,}["\']?'''
tags = ["jwt", "secret"]

[allowlist]
description = "Allowlist for false positives"
files = [
    '''\.env\.example$''',
    '''\.env\.template$''',
    '''README\.md$''',
    '''\.github/workflows/.*\.yml$''',
    '''docs/.*\.md$'''
]

regexes = [
    '''example[_-]?key''',
    '''your[_-]?key[_-]?here''',
    '''placeholder''',
    '''dummy[_-]?secret''',
    '''test[_-]?token''',
    '''fake[_-]?api[_-]?key'''
]